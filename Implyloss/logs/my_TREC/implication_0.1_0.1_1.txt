Hello 2 1
2021-04-17 22:04:15.981492: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2021-04-17 22:04:15.981565: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
Started Reading Flags

checkpoint_load_mode = mru
d_pickle_name = d_processed.p
data_dir = /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC
dropout_keep_prob = 0.8
early_stopping_p = 5
f_d_adam_lr = 0.0003
f_d_batch_size = 16
f_d_class_sampling_str = 10,10,10,10,10,10
f_d_epochs = 10
f_d_metrics_pickle_name = metrics_train_f_on_d.p
f_d_primary_metric = accuracy
f_d_U_adam_lr = 0.0003
f_d_U_batch_size = 32
f_d_U_epochs = 10
f_d_U_metrics_pickle_name = metrics_train_f_on_d_U.p
f_infer_out_pickle_name = infer_f.p
f_layers_str = 512,512
gamma = 0.1
lamda = 0.1
min_rule_coverage = 0
network_dropout = True
num_checkpoints = 1
num_classes = 0
num_load_d = 0
num_load_U = 0
num_load_validation = 0
output_dir = /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1
rule_classes_str = 
run_mode = implication
shuffle_batches = True
test_w_batch_size = 1000
U_pickle_name = U_processed.p
use_joint_f_w = False
validation_pickle_name = validation_processed.p
w_infer_out_pickle_name = infer_w.p
w_layers_str = 512,512

Hi1
Ended Reading Flags
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/d_processed.p
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/U_processed.p
Rule classes:  [2, 1, 1, 4, 3, 2, 1, 3, 5, 4, 3, 2, 4, 1, 2, 5, 4, 1, 2, 4, 3, 1, 3, 2, 1, 1, 4, 4, 5, 1, 3, 5, 2, 1, 5, 1, 5, 5, 0, 5, 5, 1, 4, 2, 3, 2, 1, 3, 5, 1, 1, 3, 2, 1, 1, 5, 2, 3, 2, 5, 3, 3, 4, 5, 5, 4, 2, 0]
length of covered U: 4637
Size of d before oversampling:  68
Size of U (covered) :  4637
Size of d after oversampling:  680
Size of d_U after combining:  5317
Loading 68 elements from d
num instances in d:  680
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/validation_processed.p
Setting value of d to 0 for test data
test_w len:  476
test_w len:  476
Number of features:  1024
Number of classes:  6
Print num of rules to train:  68
Print num of rules:  68



[Errno 2] No such file or directory: '/home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/metrics_train_f_on_d.p'
Did not find prev best metric for run type f_d. Setting to zero.
Found prev best metric for run type f_d_U: 0.722
best metrics dict:  {'f1_score_1': 0.7345454545454546, 'precision_1': 0.6644736842105263, 'recall_1': 0.8211382113821138, 'support_1': 123, 'f1_score': array([0.88888889, 0.73454545, 0.50961538, 0.76328502, 0.84931507,
       0.79452055]), 'precision': array([0.8       , 0.66447368, 0.55208333, 0.81443299, 0.86111111,
       0.79452055]), 'recall': array([1.        , 0.82113821, 0.47321429, 0.71818182, 0.83783784,
       0.79452055]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7566950614404456, 'avg_precision': 0.7477702777151497, 'avg_recall': 0.7741487835102102, 'accuracy': 0.722, 'epoch': 13.0, 'f_d_global_step': 2158}
/home/parth/.local/lib/python3.8/site-packages/tensorflow/python/keras/legacy_tf_layers/core.py:171: UserWarning: `tf.layers.dense` is deprecated and will be removed in a future version. Please use `tf.keras.layers.Dense` instead.
  warnings.warn('`tf.layers.dense` is deprecated and '
/home/parth/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer_v1.py:1719: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.
  warnings.warn('`layer.apply` is deprecated and '
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See `tf.nn.softmax_cross_entropy_with_logits_v2`.

WARNING:tensorflow:From /home/parth/Desktop/SEM6/RnD/Data_Pgm_Subset_Slc/Implyloss/my_model.py:615: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
[
    "<tf.Variable 'global_step:0' shape=() dtype=int64_ref>",
    "<tf.Variable 'f_d_global_step:0' shape=() dtype=int32_ref>",
    "<tf.Variable 'f_network/dense/kernel:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'beta1_power:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'beta2_power:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_Adam:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_Adam_1:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_Adam:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_Adam_1:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_Adam:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_Adam_1:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_Adam:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_Adam_1:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_d_U_global_step:0' shape=() dtype=int32_ref>",
    "<tf.Variable 'w_network/w_layer_0/kernel:0' shape=(1092, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/kernel:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/kernel:0' shape=(512, 1) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/bias:0' shape=(1,) dtype=float32_ref>",
    "<tf.Variable 'beta1_power_1:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'beta2_power_1:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_U_Adam:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_U_Adam_1:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_U_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_U_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_U_Adam:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_U_Adam_1:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_U_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_U_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_U_Adam:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_U_Adam_1:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_U_Adam:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_U_Adam_1:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/kernel/f_d_U_Adam:0' shape=(1092, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/kernel/f_d_U_Adam_1:0' shape=(1092, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/bias/f_d_U_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/bias/f_d_U_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/kernel/f_d_U_Adam:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/kernel/f_d_U_Adam_1:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/bias/f_d_U_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/bias/f_d_U_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/kernel/f_d_U_Adam:0' shape=(512, 1) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/kernel/f_d_U_Adam_1:0' shape=(512, 1) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/bias/f_d_U_Adam:0' shape=(1,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/bias/f_d_U_Adam_1:0' shape=(1,) dtype=float32_ref>"
]
2021-04-17 22:04:18.800329: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-17 22:04:18.801019: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 22:04:18.801174: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2021-04-17 22:04:18.801190: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-04-17 22:04:18.801210: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (parth-G3-3590): /proc/driver/nvidia/version does not exist
2021-04-17 22:04:19.073400: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2021-04-17 22:04:19.102311: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599990000 Hz
Restoring checkpoint from path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-834
Run mode is implication
begin Implication loss training
num_instances:  5317
batch_size:  32
total_batch:  166
remaining:  5
total_batch:  166
Optimization started for f_d_U with implication loss!
Batch size: 32!
Batches per epoch : 166!
Number of epochs: 10!

========== epoch : 0 ============

cost: 0.0034696158829390974

patience: 0


metrics_dict:  {'f1_score_1': 0.6880000000000001, 'precision_1': 0.6771653543307087, 'recall_1': 0.6991869918699187, 'support_1': 123, 'f1_score': array([0.762, 0.688, 0.539, 0.642, 0.811, 0.720]), 'precision': array([0.615, 0.677, 0.504, 0.964, 0.811, 0.618]), 'recall': array([1.000, 0.699, 0.580, 0.482, 0.811, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6937598170461241, 'avg_precision': 0.6980866953297128, 'avg_recall': 0.7391978043310319, 'accuracy': 0.67, 'epoch': 21.0, 'f_d_global_step': 3486}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.722 Current is: 0.67

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-166

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/f_d_U/best.ckpt-2158


========== epoch : 1 ============

cost: 0.0031427692197527357

patience: 1


metrics_dict:  {'f1_score_1': 0.701195219123506, 'precision_1': 0.6875, 'recall_1': 0.7154471544715447, 'support_1': 123, 'f1_score': array([0.762, 0.701, 0.526, 0.651, 0.829, 0.746]), 'precision': array([0.615, 0.688, 0.508, 0.877, 0.808, 0.656]), 'recall': array([1.000, 0.715, 0.545, 0.518, 0.851, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7024833533368207, 'avg_precision': 0.6920138888888889, 'avg_recall': 0.7487728132962848, 'accuracy': 0.68, 'epoch': 22.0, 'f_d_global_step': 3652}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.722 Current is: 0.68

WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/training/saver.py:968: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-333

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/f_d_U/best.ckpt-2158


========== epoch : 2 ============

cost: 0.003030535875436944

patience: 2


metrics_dict:  {'f1_score_1': 0.701195219123506, 'precision_1': 0.6875, 'recall_1': 0.7154471544715447, 'support_1': 123, 'f1_score': array([0.762, 0.701, 0.562, 0.638, 0.819, 0.754]), 'precision': array([0.615, 0.688, 0.511, 0.981, 0.813, 0.670]), 'recall': array([1.000, 0.715, 0.625, 0.473, 0.824, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7061114585168252, 'avg_precision': 0.7130852825427638, 'avg_recall': 0.7500854083588798, 'accuracy': 0.684, 'epoch': 23.0, 'f_d_global_step': 3818}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.722 Current is: 0.684

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-500

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/f_d_U/best.ckpt-2158


========== epoch : 3 ============

cost: 0.0024376361022897457

patience: 3


metrics_dict:  {'f1_score_1': 0.7078189300411523, 'precision_1': 0.7166666666666667, 'recall_1': 0.6991869918699187, 'support_1': 123, 'f1_score': array([0.700, 0.708, 0.561, 0.708, 0.847, 0.813]), 'precision': array([0.583, 0.717, 0.515, 0.829, 0.871, 0.768]), 'recall': array([0.875, 0.699, 0.616, 0.618, 0.824, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7228755535265429, 'avg_precision': 0.713985820028776, 'avg_recall': 0.7492963769296046, 'accuracy': 0.708, 'epoch': 24.0, 'f_d_global_step': 3984}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.722 Current is: 0.708

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-667

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/f_d_U/best.ckpt-2158


========== epoch : 4 ============

cost: 0.0023562519629498945

patience: 4


metrics_dict:  {'f1_score_1': 0.7091633466135459, 'precision_1': 0.6953125, 'recall_1': 0.7235772357723578, 'support_1': 123, 'f1_score': array([0.762, 0.709, 0.573, 0.762, 0.861, 0.778]), 'precision': array([0.615, 0.695, 0.604, 0.837, 0.844, 0.708]), 'recall': array([1.000, 0.724, 0.545, 0.700, 0.878, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7408198715482287, 'avg_precision': 0.7172725076430866, 'avg_recall': 0.784935361653955, 'accuracy': 0.726, 'epoch': 25.0, 'f_d_global_step': 4150}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-834

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/f_d_U/best.ckpt-4150


========== epoch : 5 ============

cost: 0.00217884711421667

patience: 0


metrics_dict:  {'f1_score_1': 0.7120000000000001, 'precision_1': 0.7007874015748031, 'recall_1': 0.7235772357723578, 'support_1': 123, 'f1_score': array([0.737, 0.712, 0.576, 0.686, 0.832, 0.768]), 'precision': array([0.636, 0.701, 0.534, 0.923, 0.827, 0.692]), 'recall': array([0.875, 0.724, 0.625, 0.545, 0.838, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.718532587707957, 'avg_precision': 0.7189255775046482, 'avg_recall': 0.7449805529491463, 'accuracy': 0.702, 'epoch': 26.0, 'f_d_global_step': 4316}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.726 Current is: 0.702

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-1001

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/f_d_U/best.ckpt-4150


========== epoch : 6 ============

cost: 0.0031053300700417613

patience: 1


metrics_dict:  {'f1_score_1': 0.7083333333333334, 'precision_1': 0.7264957264957265, 'recall_1': 0.6910569105691057, 'support_1': 123, 'f1_score': array([0.737, 0.708, 0.583, 0.716, 0.851, 0.808]), 'precision': array([0.636, 0.726, 0.533, 0.850, 0.851, 0.759]), 'recall': array([0.875, 0.691, 0.643, 0.618, 0.851, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7338340871235608, 'avg_precision': 0.7260966986870602, 'avg_recall': 0.7569101535982591, 'accuracy': 0.716, 'epoch': 27.0, 'f_d_global_step': 4482}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.726 Current is: 0.716

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-1168

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/f_d_U/best.ckpt-4150


========== epoch : 7 ============

cost: 0.0021500629250588085

patience: 2


metrics_dict:  {'f1_score_1': 0.7083333333333334, 'precision_1': 0.7264957264957265, 'recall_1': 0.6910569105691057, 'support_1': 123, 'f1_score': array([0.737, 0.708, 0.587, 0.682, 0.851, 0.797]), 'precision': array([0.636, 0.726, 0.517, 0.909, 0.851, 0.741]), 'recall': array([0.875, 0.691, 0.679, 0.545, 0.851, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7271143188448318, 'avg_precision': 0.7302474827684913, 'avg_recall': 0.750741322429428, 'accuracy': 0.708, 'epoch': 28.0, 'f_d_global_step': 4648}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.726 Current is: 0.708

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-1335

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/f_d_U/best.ckpt-4150


========== epoch : 8 ============

cost: 0.0025326204541445815

patience: 3


metrics_dict:  {'f1_score_1': 0.7171314741035857, 'precision_1': 0.703125, 'recall_1': 0.7317073170731707, 'support_1': 123, 'f1_score': array([0.667, 0.717, 0.565, 0.685, 0.834, 0.764]), 'precision': array([0.600, 0.703, 0.536, 0.897, 0.818, 0.685]), 'recall': array([0.750, 0.732, 0.598, 0.555, 0.851, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7054442821346923, 'avg_precision': 0.706524708401147, 'avg_recall': 0.7248053512190666, 'accuracy': 0.7, 'epoch': 29.0, 'f_d_global_step': 4814}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.726 Current is: 0.7

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-1502

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/f_d_U/best.ckpt-4150


========== epoch : 9 ============

cost: 0.0013843963561808194

patience: 4


metrics_dict:  {'f1_score_1': 0.7073170731707317, 'precision_1': 0.7073170731707317, 'recall_1': 0.7073170731707317, 'support_1': 123, 'f1_score': array([0.737, 0.707, 0.575, 0.686, 0.837, 0.787]), 'precision': array([0.636, 0.707, 0.526, 0.923, 0.810, 0.724]), 'recall': array([0.875, 0.707, 0.634, 0.545, 0.865, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7214789261271365, 'avg_precision': 0.7211580119750302, 'avg_recall': 0.7482631255914751, 'accuracy': 0.704, 'epoch': 30.0, 'f_d_global_step': 4980}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.726 Current is: 0.704

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/hls-model-1669

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_1/checkpoints/f_d_U/best.ckpt-4150

Optimization Finished for f_d_U!
 Implication loss training end
