Hello 2 1
2021-04-17 21:38:29.715862: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2021-04-17 21:38:29.715907: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
Started Reading Flags

checkpoint_load_mode = mru
d_pickle_name = d_processed.p
data_dir = /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC
dropout_keep_prob = 0.8
early_stopping_p = 5
f_d_adam_lr = 0.0003
f_d_batch_size = 16
f_d_class_sampling_str = 10,10,10,10,10,10
f_d_epochs = 100
f_d_metrics_pickle_name = metrics_train_f_on_d.p
f_d_primary_metric = accuracy
f_d_U_adam_lr = 0.0003
f_d_U_batch_size = 32
f_d_U_epochs = 100
f_d_U_metrics_pickle_name = metrics_train_f_on_d_U.p
f_infer_out_pickle_name = infer_f.p
f_layers_str = 512,512
gamma = 0.1
lamda = 0.1
min_rule_coverage = 0
network_dropout = True
num_checkpoints = 1
num_classes = 0
num_load_d = 0
num_load_U = 0
num_load_validation = 0
output_dir = /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6
rule_classes_str = 
run_mode = implication
shuffle_batches = True
test_w_batch_size = 1000
U_pickle_name = U_processed.p
use_joint_f_w = False
validation_pickle_name = validation_processed.p
w_infer_out_pickle_name = infer_w.p
w_layers_str = 512,512

Hi1
Ended Reading Flags
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/d_processed.p
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/U_processed.p
Rule classes:  [2, 1, 1, 4, 3, 2, 1, 3, 5, 4, 3, 2, 4, 1, 2, 5, 4, 1, 2, 4, 3, 1, 3, 2, 1, 1, 4, 4, 5, 1, 3, 5, 2, 1, 5, 1, 5, 5, 0, 5, 5, 1, 4, 2, 3, 2, 1, 3, 5, 1, 1, 3, 2, 1, 1, 5, 2, 3, 2, 5, 3, 3, 4, 5, 5, 4, 2, 0]
length of covered U: 4637
Size of d before oversampling:  68
Size of U (covered) :  4637
Size of d after oversampling:  680
Size of d_U after combining:  5317
Loading 68 elements from d
num instances in d:  680
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/validation_processed.p
Setting value of d to 0 for test data
test_w len:  476
test_w len:  476
Number of features:  1024
Number of classes:  6
Print num of rules to train:  68
Print num of rules:  68



[Errno 2] No such file or directory: '/home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/metrics_train_f_on_d.p'
Did not find prev best metric for run type f_d. Setting to zero.
[Errno 2] No such file or directory: '/home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/metrics_train_f_on_d_U.p'
Did not find prev best metric for run type f_d_U. Setting to zero.
/home/parth/.local/lib/python3.8/site-packages/tensorflow/python/keras/legacy_tf_layers/core.py:171: UserWarning: `tf.layers.dense` is deprecated and will be removed in a future version. Please use `tf.keras.layers.Dense` instead.
  warnings.warn('`tf.layers.dense` is deprecated and '
/home/parth/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer_v1.py:1719: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.
  warnings.warn('`layer.apply` is deprecated and '
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See `tf.nn.softmax_cross_entropy_with_logits_v2`.

WARNING:tensorflow:From /home/parth/Desktop/SEM6/RnD/Data_Pgm_Subset_Slc/Implyloss/my_model.py:615: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
[
    "<tf.Variable 'global_step:0' shape=() dtype=int64_ref>",
    "<tf.Variable 'f_d_global_step:0' shape=() dtype=int32_ref>",
    "<tf.Variable 'f_network/dense/kernel:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'beta1_power:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'beta2_power:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_Adam:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_Adam_1:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_Adam:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_Adam_1:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_Adam:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_Adam_1:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_Adam:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_Adam_1:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_d_U_global_step:0' shape=() dtype=int32_ref>",
    "<tf.Variable 'w_network/w_layer_0/kernel:0' shape=(1092, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/kernel:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/kernel:0' shape=(512, 1) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/bias:0' shape=(1,) dtype=float32_ref>",
    "<tf.Variable 'beta1_power_1:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'beta2_power_1:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_U_Adam:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_U_Adam_1:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_U_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_U_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_U_Adam:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_U_Adam_1:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_U_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_U_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_U_Adam:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_U_Adam_1:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_U_Adam:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_U_Adam_1:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/kernel/f_d_U_Adam:0' shape=(1092, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/kernel/f_d_U_Adam_1:0' shape=(1092, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/bias/f_d_U_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/bias/f_d_U_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/kernel/f_d_U_Adam:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/kernel/f_d_U_Adam_1:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/bias/f_d_U_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/bias/f_d_U_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/kernel/f_d_U_Adam:0' shape=(512, 1) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/kernel/f_d_U_Adam_1:0' shape=(512, 1) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/bias/f_d_U_Adam:0' shape=(1,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/bias/f_d_U_Adam_1:0' shape=(1,) dtype=float32_ref>"
]
2021-04-17 21:38:34.369629: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-17 21:38:34.370249: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-17 21:38:34.370474: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2021-04-17 21:38:34.370499: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-04-17 21:38:34.370534: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (parth-G3-3590): /proc/driver/nvidia/version does not exist
2021-04-17 21:38:34.752000: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2021-04-17 21:38:34.791250: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599990000 Hz
Run mode is implication
begin Implication loss training
num_instances:  5317
batch_size:  32
total_batch:  166
remaining:  5
total_batch:  166
Optimization started for f_d_U with implication loss!
Batch size: 32!
Batches per epoch : 166!
Number of epochs: 100!

========== epoch : 0 ============

cost: 0.3308204812367998

patience: 0

/home/parth/.local/lib/python3.8/site-packages/sklearn/metrics/classification.py:1436: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  precision = _prf_divide(tp_sum, pred_sum,

metrics_dict:  {'f1_score_1': 0.5431034482758621, 'precision_1': 0.5779816513761468, 'recall_1': 0.5121951219512195, 'support_1': 123, 'f1_score': array([0.000, 0.543, 0.519, 0.724, 0.694, 0.709]), 'precision': array([0.000, 0.578, 0.496, 0.662, 0.860, 0.659]), 'recall': array([0.000, 0.512, 0.545, 0.800, 0.581, 0.767]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.531490227737911, 'avg_precision': 0.5423990459126418, 'avg_recall': 0.534173724641065, 'accuracy': 0.622, 'epoch': 1.0, 'f_d_global_step': 166}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-166

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-166


========== epoch : 1 ============

cost: 0.09172370696036392

patience: 0


metrics_dict:  {'f1_score_1': 0.6757679180887374, 'precision_1': 0.5823529411764706, 'recall_1': 0.8048780487804879, 'support_1': 123, 'f1_score': array([0.364, 0.676, 0.502, 0.746, 0.741, 0.726]), 'precision': array([0.667, 0.582, 0.560, 0.824, 0.820, 0.679]), 'recall': array([0.250, 0.805, 0.455, 0.682, 0.676, 0.781]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6258318971751634, 'avg_precision': 0.6886464253629153, 'avg_recall': 0.6080918278232845, 'accuracy': 0.668, 'epoch': 2.0, 'f_d_global_step': 332}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/metrics_train_f_on_d_U.p

WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/training/saver.py:968: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-333

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-332


========== epoch : 2 ============

cost: 0.052837422412135696

patience: 0


metrics_dict:  {'f1_score_1': 0.6996197718631179, 'precision_1': 0.6571428571428571, 'recall_1': 0.7479674796747967, 'support_1': 123, 'f1_score': array([0.500, 0.700, 0.545, 0.755, 0.769, 0.714]), 'precision': array([0.750, 0.657, 0.529, 0.860, 0.893, 0.632]), 'recall': array([0.375, 0.748, 0.562, 0.673, 0.676, 0.822]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6639488069417456, 'avg_precision': 0.7202426380588954, 'avg_recall': 0.6426313727161538, 'accuracy': 0.684, 'epoch': 3.0, 'f_d_global_step': 498}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-500

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-498


========== epoch : 3 ============

cost: 0.031230590458403897

patience: 0


metrics_dict:  {'f1_score_1': 0.6901960784313725, 'precision_1': 0.6666666666666666, 'recall_1': 0.7154471544715447, 'support_1': 123, 'f1_score': array([0.714, 0.690, 0.520, 0.779, 0.769, 0.720]), 'precision': array([0.833, 0.667, 0.576, 0.827, 0.893, 0.586]), 'recall': array([0.625, 0.715, 0.473, 0.736, 0.676, 0.932]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6986238797513308, 'avg_precision': 0.7302802680292507, 'avg_recall': 0.6928679335900352, 'accuracy': 0.69, 'epoch': 4.0, 'f_d_global_step': 664}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-667

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-664


========== epoch : 4 ============

cost: 0.03719395493523285

patience: 0


metrics_dict:  {'f1_score_1': 0.7348484848484849, 'precision_1': 0.6879432624113475, 'recall_1': 0.7886178861788617, 'support_1': 123, 'f1_score': array([0.750, 0.735, 0.529, 0.791, 0.800, 0.758]), 'precision': array([0.750, 0.688, 0.587, 0.810, 0.848, 0.693]), 'recall': array([0.750, 0.789, 0.482, 0.773, 0.757, 0.836]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7271203165213752, 'avg_precision': 0.7293483767234924, 'avg_recall': 0.7309768685269855, 'accuracy': 0.718, 'epoch': 5.0, 'f_d_global_step': 830}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-834

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-830


========== epoch : 5 ============

cost: 0.023407755924545852

patience: 0


metrics_dict:  {'f1_score_1': 0.7196969696969698, 'precision_1': 0.6737588652482269, 'recall_1': 0.7723577235772358, 'support_1': 123, 'f1_score': array([0.824, 0.720, 0.541, 0.746, 0.817, 0.748]), 'precision': array([0.778, 0.674, 0.530, 0.920, 0.853, 0.678]), 'recall': array([0.875, 0.772, 0.554, 0.627, 0.784, 0.836]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7326707849473738, 'avg_precision': 0.7386950211981501, 'avg_recall': 0.7412670169268901, 'accuracy': 0.704, 'epoch': 6.0, 'f_d_global_step': 996}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.718 Current is: 0.704

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-1001

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-830


========== epoch : 6 ============

cost: 0.02794159887900651

patience: 1


metrics_dict:  {'f1_score_1': 0.7313432835820896, 'precision_1': 0.6758620689655173, 'recall_1': 0.7967479674796748, 'support_1': 123, 'f1_score': array([0.824, 0.731, 0.535, 0.773, 0.828, 0.797]), 'precision': array([0.778, 0.676, 0.526, 0.893, 0.845, 0.787]), 'recall': array([0.875, 0.797, 0.545, 0.682, 0.811, 0.808]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7480066325212583, 'avg_precision': 0.7506826912946387, 'avg_recall': 0.7528731658889528, 'accuracy': 0.72, 'epoch': 7.0, 'f_d_global_step': 1162}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-1168

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-1162


========== epoch : 7 ============

cost: 0.014335366263663038

patience: 0


metrics_dict:  {'f1_score_1': 0.7272727272727273, 'precision_1': 0.7394957983193278, 'recall_1': 0.7154471544715447, 'support_1': 123, 'f1_score': array([0.714, 0.727, 0.591, 0.742, 0.825, 0.770]), 'precision': array([0.833, 0.739, 0.528, 0.908, 0.855, 0.705]), 'recall': array([0.625, 0.715, 0.670, 0.627, 0.797, 0.849]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7282343778517205, 'avg_precision': 0.7614184668154739, 'avg_recall': 0.7139958507795963, 'accuracy': 0.716, 'epoch': 8.0, 'f_d_global_step': 1328}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.72 Current is: 0.716

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-1335

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-1162


========== epoch : 8 ============

cost: 0.01714594886867549

patience: 1


metrics_dict:  {'f1_score_1': 0.7185185185185183, 'precision_1': 0.6598639455782312, 'recall_1': 0.7886178861788617, 'support_1': 123, 'f1_score': array([0.800, 0.719, 0.539, 0.730, 0.845, 0.776]), 'precision': array([0.857, 0.660, 0.525, 0.956, 0.882, 0.696]), 'recall': array([0.750, 0.789, 0.554, 0.591, 0.811, 0.877]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7348023383742666, 'avg_precision': 0.7627196665942231, 'avg_recall': 0.7284369242062191, 'accuracy': 0.708, 'epoch': 9.0, 'f_d_global_step': 1494}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.72 Current is: 0.708

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-1502

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-1162


========== epoch : 9 ============

cost: 0.00847990456467338

patience: 2


metrics_dict:  {'f1_score_1': 0.6986899563318778, 'precision_1': 0.7547169811320755, 'recall_1': 0.6504065040650406, 'support_1': 123, 'f1_score': array([0.800, 0.699, 0.571, 0.674, 0.826, 0.805]), 'precision': array([0.857, 0.755, 0.469, 0.935, 0.891, 0.744]), 'recall': array([0.750, 0.650, 0.732, 0.527, 0.770, 0.877]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7292759225790387, 'avg_precision': 0.7751210307209551, 'avg_recall': 0.7178007812530032, 'accuracy': 0.694, 'epoch': 10.0, 'f_d_global_step': 1660}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.72 Current is: 0.694

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-1669

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-1162


========== epoch : 10 ============

cost: 0.023178188595394823

patience: 3


metrics_dict:  {'f1_score_1': 0.725, 'precision_1': 0.7435897435897436, 'recall_1': 0.7073170731707317, 'support_1': 123, 'f1_score': array([0.762, 0.725, 0.597, 0.762, 0.834, 0.787]), 'precision': array([0.615, 0.744, 0.580, 0.837, 0.818, 0.744]), 'recall': array([1.000, 0.707, 0.616, 0.700, 0.851, 0.836]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7447029095362309, 'avg_precision': 0.7229745117821346, 'avg_recall': 0.7850593819082793, 'accuracy': 0.73, 'epoch': 11.0, 'f_d_global_step': 1826}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-1836

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-1826


========== epoch : 11 ============

cost: 0.013254968543447198

patience: 0


metrics_dict:  {'f1_score_1': 0.713235294117647, 'precision_1': 0.6510067114093959, 'recall_1': 0.7886178861788617, 'support_1': 123, 'f1_score': array([0.667, 0.713, 0.525, 0.738, 0.855, 0.770]), 'precision': array([1.000, 0.651, 0.500, 0.896, 0.873, 0.760]), 'recall': array([0.500, 0.789, 0.554, 0.627, 0.838, 0.781]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7114560480166249, 'avg_precision': 0.780058340688835, 'avg_recall': 0.6813536329448459, 'accuracy': 0.702, 'epoch': 12.0, 'f_d_global_step': 1992}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.73 Current is: 0.702

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-2003

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-1826


========== epoch : 12 ============

cost: 0.00870761581365996

patience: 1


metrics_dict:  {'f1_score_1': 0.7335907335907336, 'precision_1': 0.6985294117647058, 'recall_1': 0.7723577235772358, 'support_1': 123, 'f1_score': array([0.800, 0.734, 0.545, 0.745, 0.838, 0.795]), 'precision': array([0.667, 0.699, 0.529, 0.849, 0.838, 0.795]), 'recall': array([1.000, 0.772, 0.562, 0.664, 0.838, 0.795]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7427169373353326, 'avg_precision': 0.7293005730371038, 'avg_recall': 0.7718087454994405, 'accuracy': 0.718, 'epoch': 13.0, 'f_d_global_step': 2158}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.73 Current is: 0.718

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-2170

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-1826


========== epoch : 13 ============

cost: 0.02379263880777807

patience: 2


metrics_dict:  {'f1_score_1': 0.7153284671532848, 'precision_1': 0.6490066225165563, 'recall_1': 0.7967479674796748, 'support_1': 123, 'f1_score': array([0.769, 0.715, 0.527, 0.600, 0.733, 0.713]), 'precision': array([1.000, 0.649, 0.460, 0.960, 0.957, 0.622]), 'recall': array([0.625, 0.797, 0.616, 0.436, 0.595, 0.836]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.6763434032278263, 'avg_precision': 0.7746628902064713, 'avg_recall': 0.6507323442275833, 'accuracy': 0.65, 'epoch': 14.0, 'f_d_global_step': 2324}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.73 Current is: 0.65

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-2337

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-1826


========== epoch : 14 ============

cost: 0.007381037327317005

patience: 3


metrics_dict:  {'f1_score_1': 0.7287449392712552, 'precision_1': 0.7258064516129032, 'recall_1': 0.7317073170731707, 'support_1': 123, 'f1_score': array([0.750, 0.729, 0.583, 0.726, 0.821, 0.800]), 'precision': array([0.750, 0.726, 0.533, 0.942, 0.805, 0.736]), 'recall': array([0.750, 0.732, 0.643, 0.591, 0.838, 0.877]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7348649878181025, 'avg_precision': 0.7486659599260558, 'avg_recall': 0.7383372862407276, 'accuracy': 0.718, 'epoch': 15.0, 'f_d_global_step': 2490}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.73 Current is: 0.718

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-2504

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-1826


========== epoch : 15 ============

cost: 0.004138067222323892

patience: 4


metrics_dict:  {'f1_score_1': 0.7250996015936255, 'precision_1': 0.7109375, 'recall_1': 0.7398373983739838, 'support_1': 123, 'f1_score': array([0.778, 0.725, 0.575, 0.671, 0.803, 0.818]), 'precision': array([0.700, 0.711, 0.526, 0.921, 0.759, 0.778]), 'recall': array([0.875, 0.740, 0.634, 0.527, 0.851, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7281709974821386, 'avg_precision': 0.732385378152823, 'avg_recall': 0.7484006245094618, 'accuracy': 0.706, 'epoch': 16.0, 'f_d_global_step': 2656}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.73 Current is: 0.706

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/hls-model-2671

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/implication_0.1_0.1_6/checkpoints/f_d_U/best.ckpt-1826


========== epoch : 16 ============

cost: 0.0038144967197859575

patience: 5


metrics_dict:  {'f1_score_1': 0.7226890756302521, 'precision_1': 0.7478260869565218, 'recall_1': 0.6991869918699187, 'support_1': 123, 'f1_score': array([0.750, 0.723, 0.582, 0.685, 0.805, 0.824]), 'precision': array([0.750, 0.748, 0.510, 0.897, 0.775, 0.787]), 'recall': array([0.750, 0.699, 0.679, 0.555, 0.838, 0.863]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.7281970049906555, 'avg_precision': 0.7445753374299823, 'avg_recall': 0.7305259019091296, 'accuracy': 0.708, 'epoch': 17.0, 'f_d_global_step': 2822}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.73 Current is: 0.708
bye! stopping early!......
Optimization Finished for f_d_U!
 Implication loss training end
