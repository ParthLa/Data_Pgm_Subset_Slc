Hello 2 1
2021-04-18 09:53:58.314475: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory
2021-04-18 09:53:58.314536: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/compat/v2_compat.py:96: disable_resource_variables (from tensorflow.python.ops.variable_scope) is deprecated and will be removed in a future version.
Instructions for updating:
non-resource variables are not supported in the long term
Started Reading Flags

checkpoint_load_mode = mru
d_pickle_name = d_processed.p
data_dir = /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC
dropout_keep_prob = 0.8
early_stopping_p = 20
f_d_adam_lr = 0.0003
f_d_batch_size = 16
f_d_class_sampling_str = 10,10,10,10,10,10
f_d_epochs = 7
f_d_metrics_pickle_name = metrics_train_f_on_d.p
f_d_primary_metric = accuracy
f_d_U_adam_lr = 0.0003
f_d_U_batch_size = 32
f_d_U_epochs = 7
f_d_U_metrics_pickle_name = metrics_train_f_on_d_U.p
f_infer_out_pickle_name = infer_f.p
f_layers_str = 512,512
gamma = 0.1
lamda = 0.01
min_rule_coverage = 0
network_dropout = True
num_checkpoints = 1
num_classes = 0
num_load_d = 0
num_load_U = 0
num_load_validation = 0
output_dir = /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2
rule_classes_str = 
run_mode = learn2reweight
shuffle_batches = True
test_w_batch_size = 1000
U_pickle_name = U_processed.p
use_joint_f_w = False
validation_pickle_name = validation_processed.p
w_infer_out_pickle_name = infer_w.p
w_layers_str = 512,512

Hi1
Ended Reading Flags
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/d_processed.p
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/U_processed.p
Rule classes:  [2, 1, 1, 4, 3, 2, 1, 3, 5, 4, 3, 2, 4, 1, 2, 5, 4, 1, 2, 4, 3, 1, 3, 2, 1, 1, 4, 4, 5, 1, 3, 5, 2, 1, 5, 1, 5, 5, 0, 5, 5, 1, 4, 2, 3, 2, 1, 3, 5, 1, 1, 3, 2, 1, 1, 5, 2, 3, 2, 5, 3, 3, 4, 5, 5, 4, 2, 0]
length of covered U: 4637
Size of d before oversampling:  68
Size of U (covered) :  4637
Size of d after oversampling:  680
Size of d_U after combining:  5317
Loading 68 elements from d
num instances in d:  680
Loading from hoff  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/validation_processed.p
Setting value of d to 0 for test data
test_w len:  476
test_w len:  476
Number of features:  1024
Number of classes:  6
Print num of rules to train:  68
Print num of rules:  68



[Errno 2] No such file or directory: '/home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/metrics_train_f_on_d.p'
Did not find prev best metric for run type f_d. Setting to zero.
[Errno 2] No such file or directory: '/home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/metrics_train_f_on_d_U.p'
Did not find prev best metric for run type f_d_U. Setting to zero.
/home/parth/.local/lib/python3.8/site-packages/tensorflow/python/keras/legacy_tf_layers/core.py:171: UserWarning: `tf.layers.dense` is deprecated and will be removed in a future version. Please use `tf.keras.layers.Dense` instead.
  warnings.warn('`tf.layers.dense` is deprecated and '
/home/parth/.local/lib/python3.8/site-packages/tensorflow/python/keras/engine/base_layer_v1.py:1719: UserWarning: `layer.apply` is deprecated and will be removed in a future version. Please use `layer.__call__` method instead.
  warnings.warn('`layer.apply` is deprecated and '
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: calling dropout (from tensorflow.python.ops.nn_ops) with keep_prob is deprecated and will be removed in a future version.
Instructions for updating:
Please use `rate` instead of `keep_prob`. Rate should be set to `rate = 1 - keep_prob`.
WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/util/dispatch.py:201: softmax_cross_entropy_with_logits (from tensorflow.python.ops.nn_ops) is deprecated and will be removed in a future version.
Instructions for updating:

Future major versions of TensorFlow will allow gradients to flow
into the labels input on backprop by default.

See `tf.nn.softmax_cross_entropy_with_logits_v2`.

WARNING:tensorflow:From /home/parth/Desktop/SEM6/RnD/Data_Pgm_Subset_Slc/Implyloss/my_model.py:615: to_float (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
WARNING:tensorflow:From /home/parth/Desktop/SEM6/RnD/Data_Pgm_Subset_Slc/Implyloss/my_model.py:406: to_int32 (from tensorflow.python.ops.math_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use `tf.cast` instead.
[
    "<tf.Variable 'global_step:0' shape=() dtype=int64_ref>",
    "<tf.Variable 'f_d_global_step:0' shape=() dtype=int32_ref>",
    "<tf.Variable 'f_network/dense/kernel:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'beta1_power:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'beta2_power:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_Adam:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_Adam_1:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_Adam:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_Adam_1:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_Adam:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_Adam_1:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_Adam:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_Adam_1:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_d_U_global_step:0' shape=() dtype=int32_ref>",
    "<tf.Variable 'w_network/w_layer_0/kernel:0' shape=(1092, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_0/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/kernel:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_layer_1/bias:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/kernel:0' shape=(512, 1) dtype=float32_ref>",
    "<tf.Variable 'w_network/w_linear_layer/bias:0' shape=(1,) dtype=float32_ref>",
    "<tf.Variable 'raw_d_x:0' shape=(68, 1024) dtype=float32_ref>",
    "<tf.Variable 'raw_d_L:0' shape=(68, 1) dtype=int32_ref>",
    "<tf.Variable 'beta1_power_1:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'beta2_power_1:0' shape=() dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_U_Adam:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/kernel/f_d_U_Adam_1:0' shape=(1024, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_U_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense/bias/f_d_U_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_U_Adam:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/kernel/f_d_U_Adam_1:0' shape=(512, 512) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_U_Adam:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_1/bias/f_d_U_Adam_1:0' shape=(512,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_U_Adam:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/kernel/f_d_U_Adam_1:0' shape=(512, 6) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_U_Adam:0' shape=(6,) dtype=float32_ref>",
    "<tf.Variable 'f_network/dense_2/bias/f_d_U_Adam_1:0' shape=(6,) dtype=float32_ref>"
]
2021-04-18 09:54:03.210497: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2021-04-18 09:54:03.211212: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2021-04-18 09:54:03.211374: W tensorflow/stream_executor/platform/default/dso_loader.cc:60] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2021-04-18 09:54:03.211394: W tensorflow/stream_executor/cuda/cuda_driver.cc:326] failed call to cuInit: UNKNOWN ERROR (303)
2021-04-18 09:54:03.211415: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (parth-G3-3590): /proc/driver/nvidia/version does not exist
2021-04-18 09:54:03.475718: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2021-04-18 09:54:03.492158: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2599990000 Hz
Run mode is learn2reweight
learn2reweight
num_instances:  5317
batch_size:  32
total_batch:  166
remaining:  5
total_batch:  166
Optimization started for f_d_U with learn2reweight loss!
Batch size: 32!
Batches per epoch : 166!
Number of epochs: 7!

========== epoch : 0 ============

cost: 1.3621117463672023

patience: 0

/home/parth/.local/lib/python3.8/site-packages/sklearn/metrics/classification.py:1436: UndefinedMetricWarning: Precision and F-score are ill-defined and being set to 0.0 in labels with no predicted samples.
  precision = _prf_divide(tp_sum, pred_sum,

metrics_dict:  {'f1_score_1': 0.5146579804560261, 'precision_1': 0.42934782608695654, 'recall_1': 0.6422764227642277, 'support_1': 123, 'f1_score': array([0.000, 0.515, 0.231, 0.627, 0.460, 0.463]), 'precision': array([0.000, 0.429, 0.328, 0.929, 0.885, 0.329]), 'recall': array([0.000, 0.642, 0.179, 0.473, 0.311, 0.781]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.38263208525518716, 'avg_precision': 0.4833138767531522, 'avg_recall': 0.39753464211365985, 'accuracy': 0.462, 'epoch': 1.0, 'f_d_global_step': 166}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/hls-model-166

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/f_d_U/best.ckpt-166


========== epoch : 1 ============

cost: 0.7797827717949105

patience: 0


metrics_dict:  {'f1_score_1': 0.5422535211267606, 'precision_1': 0.4782608695652174, 'recall_1': 0.6260162601626016, 'support_1': 123, 'f1_score': array([0.000, 0.542, 0.286, 0.570, 0.510, 0.498]), 'precision': array([0.000, 0.478, 0.333, 0.855, 0.929, 0.355]), 'recall': array([0.000, 0.626, 0.250, 0.427, 0.351, 0.836]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.40090464696335215, 'avg_precision': 0.491560374801022, 'avg_recall': 0.41504279619047413, 'accuracy': 0.478, 'epoch': 2.0, 'f_d_global_step': 332}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/metrics_train_f_on_d_U.p

WARNING:tensorflow:From /home/parth/.local/lib/python3.8/site-packages/tensorflow/python/training/saver.py:968: remove_checkpoint (from tensorflow.python.training.checkpoint_management) is deprecated and will be removed in a future version.
Instructions for updating:
Use standard file APIs to delete files with this prefix.
Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/hls-model-333

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/f_d_U/best.ckpt-332


========== epoch : 2 ============

cost: 0.6305700612355428

patience: 0


metrics_dict:  {'f1_score_1': 0.5300546448087432, 'precision_1': 0.3991769547325103, 'recall_1': 0.7886178861788617, 'support_1': 123, 'f1_score': array([0.000, 0.530, 0.237, 0.585, 0.510, 0.598]), 'precision': array([0.000, 0.399, 0.297, 0.889, 0.929, 0.515]), 'recall': array([0.000, 0.789, 0.196, 0.436, 0.351, 0.712]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.4099141182076902, 'avg_precision': 0.5047976757731066, 'avg_recall': 0.4141817020742848, 'accuracy': 0.49, 'epoch': 3.0, 'f_d_global_step': 498}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/hls-model-500

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/f_d_U/best.ckpt-498


========== epoch : 3 ============

cost: 0.6524274977574864

patience: 0


metrics_dict:  {'f1_score_1': 0.527536231884058, 'precision_1': 0.4099099099099099, 'recall_1': 0.7398373983739838, 'support_1': 123, 'f1_score': array([0.000, 0.528, 0.269, 0.626, 0.542, 0.615]), 'precision': array([0.000, 0.410, 0.338, 0.653, 0.879, 0.629]), 'recall': array([0.000, 0.740, 0.223, 0.600, 0.392, 0.603]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.42989775723295254, 'avg_precision': 0.4847620669402848, 'avg_recall': 0.42628055033459306, 'accuracy': 0.51, 'epoch': 4.0, 'f_d_global_step': 664}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/hls-model-667

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/f_d_U/best.ckpt-664


========== epoch : 4 ============

cost: 0.5501504701349027

patience: 0


metrics_dict:  {'f1_score_1': 0.5423728813559323, 'precision_1': 0.4155844155844156, 'recall_1': 0.7804878048780488, 'support_1': 123, 'f1_score': array([0.000, 0.542, 0.201, 0.603, 0.519, 0.625]), 'precision': array([0.000, 0.416, 0.298, 0.722, 0.900, 0.534]), 'recall': array([0.000, 0.780, 0.152, 0.518, 0.365, 0.753]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.4151602809523279, 'avg_precision': 0.47822159991425783, 'avg_recall': 0.42812414329078213, 'accuracy': 0.504, 'epoch': 5.0, 'f_d_global_step': 830}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.51 Current is: 0.504

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/hls-model-834

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/f_d_U/best.ckpt-664


========== epoch : 5 ============

cost: 0.5031870355807155

patience: 1


metrics_dict:  {'f1_score_1': 0.5469613259668509, 'precision_1': 0.41422594142259417, 'recall_1': 0.8048780487804879, 'support_1': 123, 'f1_score': array([0.000, 0.547, 0.221, 0.649, 0.547, 0.623]), 'precision': array([0.000, 0.414, 0.317, 0.800, 0.906, 0.553]), 'recall': array([0.000, 0.805, 0.170, 0.545, 0.392, 0.712]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.43107741825205964, 'avg_precision': 0.4983890162418272, 'avg_recall': 0.43736601839884504, 'accuracy': 0.518, 'epoch': 6.0, 'f_d_global_step': 996}

Reporting f_d metrics to tensorboard

dumped metrics dict to file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/metrics_train_f_on_d_U.p

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/hls-model-1001

Saved new best checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/f_d_U/best.ckpt-996


========== epoch : 6 ============

cost: 0.5012447351185848

patience: 0


metrics_dict:  {'f1_score_1': 0.5255102040816326, 'precision_1': 0.3828996282527881, 'recall_1': 0.8373983739837398, 'support_1': 123, 'f1_score': array([0.000, 0.526, 0.208, 0.593, 0.514, 0.640]), 'precision': array([0.000, 0.383, 0.295, 0.823, 0.871, 0.623]), 'recall': array([0.000, 0.837, 0.161, 0.464, 0.365, 0.658]), 'support': array([  8, 123, 112, 110,  74,  73]), 'avg_f1_score': 0.4134852766217389, 'avg_precision': 0.49915110098988347, 'avg_recall': 0.41402468912909945, 'accuracy': 0.494, 'epoch': 7.0, 'f_d_global_step': 1162}

Reporting f_d metrics to tensorboard
Not saving metrics dict. Best metric value is 0.518 Current is: 0.494

Saved MRU checkpoint to path:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/hls-model-1168

No new best checkpoint. Did not save a new best checkpoint. Last checkpointed file:  /home/parth/Desktop/SEM6/RnD/Learning-From-Rules/data/TREC/outputs/learn2reweight_0.1_0.01_2/checkpoints/f_d_U/best.ckpt-996

Optimization Finished for f_d_U!
